#include <cstring>
#include <stdlib.h>
#include <stdlib.h>

#include <SPI.h>
#include "SdFat.h"

#include <Wire.h>

#include <SparkFun_MAX1704x_Fuel_Gauge_Arduino_Library.h>

#include <ArduinoBLE.h>
#include "utility/ATT.h"

#include "appservice.hpp"
#include "communicationservice.hpp"
#include "opcodes.h"
#include "modes.h"
#include "result.h"
#include "doubledringbuffer.hpp"
#include "string_utils.hpp"
#include "pan_tompkins.hpp"

#include "NRF52_MBED_TimerInterrupt.h"
#include "NRF52_MBED_ISR_Timer.h"

#define TRUE 1
#define FALSE 0

//If sd card should be used (init etc.)
#define USE_SD_CARD FALSE

//If serial should be used (for print debug messages)
#define USE_SERIAL TRUE

//If the battery should be init (needed for battery status)
#define USE_BATTERY TRUE


#define SAMPLETIME 5

#define HW_TIMER_INTERVAL_MS 1000
#define RINGBUFFERSIZE 500

/* Constants used for the meta file */
const String META_FILE_ECG_START = "start_time";
const String META_FILE_ECG_END = "end_time";
const String META_FILE_ECG_WAS_ABORTED = "aborted";

//24H in ms
const int FULL_EKG_TIME = 70000; //86400000

//Delay between sending of the battery status
const int BATTERY_SEND_DELAY = 60000;
//boolean if the batter status should be send right away (e.g after a device connected)
bool SEND_BATTERY_STATUS = false;

//Doubled ring buffer which is used to as storage for the 24H ekg
DoubledRingBuffer<short> LONG_TIME_DOUBLE_BUFFER;

const uint16_t SAADC_RESULT_BUFFER_SIZE = 10;  // Buffer f√ºr ADC
volatile nrf_saadc_value_t SAADC_RESULT_BUFFER[SAADC_RESULT_BUFFER_SIZE];

short testdata[] = { 1866, 1871, 1866, 1876, 1869, 1873, 1877, 1869, 1879, 1871, 1872, 1877, 1871, 1881, 1874, 1876, 1882, 1876, 1888, 1886, 1889, 1894, 1887, 1897, 1889, 1890, 1893, 1886, 1893, 1884, 1885, 1890, 1882, 1892, 1883, 1886, 1890, 1883, 1891, 1883, 1885, 1888, 1882, 1891, 1881, 1882, 1887, 1879, 1886, 1881, 1882, 1888, 1881, 1888, 1883, 1883, 1887, 1882, 1888, 1883, 1883, 1887, 1882, 1886, 1881, 1881, 1886, 1881, 1886, 1882, 1882, 1887, 1881, 1887, 1881, 1881, 1886, 1881, 1886, 1884, 1883, 1889, 1886, 1890, 1885, 1884, 1886, 1878, 1883, 1880, 1879, 1885, 1881, 1885, 1876, 1862, 1891, 1960, 2069, 2078, 2017, 1894, 1835, 1824, 1824, 1828, 1837, 1837, 1847, 1848, 1850, 1860, 1857, 1866, 1865, 1866, 1874, 1871, 1877, 1874, 1874, 1878, 1872, 1877, 1874, 1874, 1880, 1874, 1881, 1879, 1879, 1887, 1885, 1892, 1891, 1890, 1895, 1888, 1892, 1887, 1885, 1890, 1883, 1886, 1884, 1883, 1889, 1882, 1886, 1883, 1883, 1890, 1882, 1887, 1886, 1885, 1888, 1883, 1887, 1886, 1884, 1889, 1883, 1888, 1886, 1882, 1889, 1882, 1887, 1886, 1882, 1889, 1882, 1885, 1883, 1882, 1889, 1881, 1884, 1884, 1881, 1887, 1881, 1885, 1884, 1882, 1888, 1883, 1886, 1885, 1883, 1890, 1883, 1887, 1889, 1887, 1893, 1884, 1885, 1882, 1878, 1884, 1877, 1882, 1882, 1881, 1886, 1864, 1877, 1923, 2022, 2069, 2038, 1934, 1860, 1828, 1835, 1831, 1838, 1842, 1843, 1855, 1850, 1859, 1863, 1862, 1871, 1867, 1871, 1872, 1871, 1879, 1872, 1876, 1877, 1873, 1879, 1873, 1876, 1879, 1874, 1882, 1878, 1882, 1885, 1885, 1893, 1887, 1890, 1891, 1886, 1894, 1886, 1888, 1889, 1886, 1890, 1884, 1886, 1886, 1883, 1888, 1882, 1884, 1884, 1881, 1888, 1882, 1885, 1887, 1883, 1889, 1883, 1886, 1886, 1882, 1887, 1881, 1883, 1884, 1881, 1887, 1879, 1884, 1885, 1882, 1888, 1882, 1884, 1886, 1882, 1889, 1882, 1885, 1886, 1883, 1889, 1884, 1884, 1886, 1882, 1889, 1882, 1883, 1888, 1884, 1891, 1885, 1889, 1893, 1888, 1892, 1886, 1884, 1884, 1880, 1886, 1881, 1883, 1885, 1880, 1882, 1862, 1884, 1956, 2060, 2084, 2028, 1901, 1847, 1821, 1827, 1826, 1834, 1841, 1841, 1852, 1851, 1857, 1862, 1861, 1869, 1867, 1869, 1873, 1870, 1876, 1872, 1872, 1876, 1872, 1878, 1872, 1874, 1878, 1874, 1881, 1878, 1880, 1887, 1886, 1894, 1891, 1891, 1895, 1889, 1893, 1887, 1887, 1891, 1886, 1891, 1885, 1885, 1889, 1884, 1889, 1884, 1884, 1888, 1882, 1888, 1883, 1884, 1888, 1882, 1888, 1883, 1883, 1889, 1884, 1888, 1885, 1884, 1888, 1882, 1887, 1884, 1883, 1887, 1882, 1886, 1882, 1882, 1887, 1881, 1886, 1882, 1882, 1887, 1880, 1885, 1881, 1881, 1887, 1880, 1884, 1883, 1882, 1887, 1881, 1887, 1887, 1886, 1889, 1881, 1884, 1879, 1879, 1885, 1878, 1883, 1882, 1879, 1884, 1861, 1876, 1922, 2028, 2074, 2041, 1936, 1861, 1827, 1831, 1828, 1835, 1839, 1843, 1852, 1851, 1858, 1858, 1858, 1869, 1864, 1870, 1871, 1870, 1877, 1871, 1876, 1874, 1873, 1879, 1873, 1878, 1878, 1876, 1882, 1877, 1883, 1885, 1886, 1894, 1887, 1892, 1890, 1887, 1891, 1885, 1888, 1886, 1883, 1889, 1882, 1886, 1885, 1882, 1889, 1881, 1885, 1884, 1881, 1889, 1882, 1885, 1885, 1882, 1887, 1882, 1885, 1884, 1882, 1887, 1882, 1885, 1883, 1881, 1886, 1881, 1884, 1883, 1881, 1888, 1879, 1883, 1884, 1881, 1887, 1881, 1886, 1885, 1882, 1889, 1884, 1886, 1888, 1887, 1892, 1885, 1886, 1884, 1879, 1884, 1878, 1882, 1883, 1880, 1886, 1881, 1871, 1866, 1895, 1988, 2063, 2059, 1980, 1879, 1844, 1825, 1831, 1836, 1837, 1847, 1845, 1851, 1856, 1858, 1865, 1862, 1866, 1870, 1868, 1875, 1870, 1875, 1875, 1872, 1877, 1872, 1874, 1874, 1872, 1879, 1875, 1878, 1881, 1880, 1890, 1888, 1890, 1892, 1889, 1894, 1885, 1889, 1889, 1885, 1890, 1882, 1885, 1884, 1882, 1888, 1883, 1884, 1885, 1883, 1887, 1880, 1883, 1884, 1882, 1887, 1880, 1883, 1885, 1882, 1888, 1882, 1885, 1884, 1881, 1887, 1881, 1883, 1885, 1882, 1887, 1881, 1883, 1885, 1883, 1887, 1882, 1883, 1886, 1882, 1887, 1885, 1889, 1889, 1883, 1888, 1881, 1879, 1884, 1878, 1884, 1879, 1881, 1885, 1873, 1864, 1879, 1945, 2056, 2072, 2034, 1905, 1843, 1824, 1822, 1832, 1831, 1837, 1846, 1846, 1856, 1853, 1857, 1865, 1861, 1868, 1865, 1868, 1873, 1868, 1875, 1872, 1870, 1874, 1867, 1874, 1870, 1872, 1877, 1873, 1881, 1880, 1883, 1890, 1887, 1892, 1889, 1888, 1891, 1885, 1889, 1884, 1882, 1889, 1882, 1887, 1883, 1882, 1886, 1881, 1886, 1882, 1882, 1887, 1880, 1883, 1879, 1879, 1885, 1879, 1886, 1883, 1882, 1886, 1880, 1886, 1880, 1881, 1886, 1881, 1887, 1885, 1886, 1892, 1885, 1888, 1883, 1881, 1884, 1877, 1883, 1879, 1878, 1884, 1880, 1885, 1875, 1861, 1894, 1968, 2075, 2083, 2007, 1891, 1836, 1823, 1823, 1826, 1836, 1834, 1845, 1847, 1850, 1860, 1855, 1864, 1863, 1864, 1871, 1866, 1872, 1870, 1869, 1876, 1869, 1874, 1870, 1870, 1876, 1869, 1876, 1875, 1877, 1889, 1886, 1893, 1893, 1893, 1897, 1891, 1895, 1893, 1888, 1894, 1887, 1890, 1886, 1885, 1891, 1883, 1887, 1884, 1881, 1887, 1880, 1886, 1885, 1883, 1888, 1883, 1887, 1885, 1881, 1889, 1882, 1887, 1884, 1882, 1888, 1883, 1888, 1887, 1884, 1892, 1884, 1887, 1884, 1880, 1886, 1879, 1884, 1882, 1879, 1888, 1879, 1874, 1863, 1886, 1979, 2071, 2074, 1986, 1879, 1843, 1820, 1828, 1831, 1831, 1843, 1841, 1851, 1852, 1850, 1862, 1859, 1864, 1867, 1865, 1875, 1868, 1870, 1871, 1868, 1874, 1866, 1872, 1874, 1871, 1879, 1873, 1877, 1878, 1878, 1890, 1885, 1890, 1891, 1888, 1895, 1886, 1890, 1891, 1883, 1889, 1883, 1887, 1888, 1884, 1890, 1884, 1885, 1884, 1882, 1889, 1882, 1885, 1886, 1881, 1889, 1882, 1882, 1884, 1879, 1887, 1881, 1885, 1887, 1882, 1890, 1880, 1886, 1889, 1882, 1889, 1881, 1883, 1883, 1879, 1886, 1880, 1878, 1882, 1880, 1886, 1872, 1863, 1885, 1939, 2042, 2050, 2006, 1903, 1848, 1835, 1830, 1834, 1840, 1842, 1854, 1847, 1854, 1860, 1860, 1869, 1866, 1869, 1874, 1871, 1877, 1870, 1873, 1876, 1873, 1879, 1873, 1877, 1880, 1873, 1882, 1879, 1881, 1886, 1883, 1893, 1888, 1889, 1891, 1886, 1892, 1885, 1886, 1889, 1882, 1888, 1884, 1885, 1888, 1883, 1889, 1883, 1884, 1888, 1880, 1886, 1882, 1885, 1889, 1880, 1888, 1883, 1884, 1886, 1882, 1887, 1882, 1883, 1886, 1882, 1890, 1887, 1888, 1892, 1886, 1890, 1884, 1880, 1885, 1879, 1884, 1879, 1880, 1886, 1879, 1881, 1862, 1878, 1935, 2029, 2063, 2020, 1911, 1858, 1830, 1835, 1835, 1838, 1847, 1846, 1857, 1857, 1859, 1866, 1864, 1872, 1868, 1869, 1877, 1871, 1876, 1873, 1874, 1879, 1873, 1878, 1873, 1873, 1879, 1873, 1882, 1879, 1882, 1891, 1888, 1894, 1890, 1891, 1895, 1888, 1893, 1888, 1886, 1891, 1885, 1890, 1887, 1886, 1891, 1885, 1889, 1886, 1885, 1890, 1884, 1889, 1885, 1885, 1889, 1883, 1889, 1886, 1884, 1890, 1883, 1888, 1885, 1884, 1891, 1884, 1888, 1886, 1885, 1890, 1883, 1889, 1886, 1886, 1894, 1884, 1889, 1885, 1881, 1887, 1880, 1885, 1882, 1881, 1888, 1880, 1876, 1867, 1893, 1980, 2066, 2069, 1991, 1882, 1848, 1825, 1833, 1835, 1837, 1848, 1846, 1854, 1857, 1857, 1866, 1861, 1869, 1870, 1870, 1877, 1871, 1876, 1875, 1873, 1880, 1873, 1877, 1875, 1873, 1881, 1874, 1880, 1881, 1882, 1892, 1887, 1893, 1892, 1890, 1896, 1889, 1891, 1890, 1887, 1893, 1885, 1889, 1887, 1883, 1889, 1882, 1886, 1886, 1883, 1890, 1883, 1886, 1886, 1883, 1889, 1882, 1886, 1885, 1883, 1888, 1882, 1886, 1885, 1881, 1889, 1883, 1885, 1885, 1882, 1888, 1883, 1886, 1885, 1883, 1889, 1882, 1887, 1888, 1886, 1894, 1885, 1888, 1885, 1878, 1886, 1880, 1882, 1884, 1880, 1886, 1880, 1874, 1867, 1888, 1962, 2046, 2051, 1995, 1890, 1853, 1829, 1833, 1838, 1838, 1849, 1846, 1853, 1858, 1857, 1867, 1862, 1866, 1871, 1869, 1877, 1870, 1874, 1876, 1872, 1879, 1873, 1876, 1879, 1875, 1882, 1877, 1880, 1884, 1880, 1891, 1885, 1889, 1889, 1884, 1892, 1885, 1885, 1887, 1881, 1889, 1882, 1884, 1886, 1882, 1889, 1881, 1883, 1886, 1882, 1889, 1883, 1885, 1887, 1883, 1888, 1883, 1884, 1887, 1882, 1889, 1882, 1883, 1887, 1881, 1889, 1883, 1884, 1887, 1881, 1888, 1881, 1882, 1887, 1883, 1891, 1887, 1889, 1891, 1885, 1892, 1884, 1881, 1885, 1881, 1887, 1881, 1882, 1887, 1879, 1871, 1874, 1916, 2015, 2047, 2032, 1934, 1867, 1842, 1832, 1840, 1839, 1843, 1850, 1849, 1859, 1859, 1862, 1870, 1865, 1874, 1871, 1872, 1879, 1874, 1879, 1876, 1875, 1881, 1874, 1881, 1876, 1877, 1884, 1877, 1883, 1881, 1882, 1890, 1886, 1892, 1888, 1887, 1890, 1884, 1889, 1884, 1884, 1889, 1883, 1889, 1886, 1885, 1890, 1884, 1889, 1885, 1885, 1889, 1882, 1889, 1884, 1884, 1888, 1883, 1889, 1885, 1886, 1891, 1883, 1889, 1885, 1884, 1889, 1883, 1888, 1883, 1883, 1889, 1882, 1888, 1884, 1885, 1889, 1883, 1888, 1885, 1883, 1889, 1884, 1890, 1888, 1889, 1894, 1887, 1890, 1883, 1881, 1887, 1880, 1886, 1882, 1882, 1887, 1879, 1869, 1879, 1931, 2045, 2075, 2048, 1927, 1853, 1833, 1824, 1835, 1835, 1839, 1848, 1846, 1854, 1857, 1859, 1868, 1863, 1871, 1869, 1869, 1876, 1872, 1877, 1875, 1874, 1880, 1873, 1878, 1875, 1874, 1882, 1875, 1881, 1881, 1884, 1892, 1886, 1892, 1890, 1888, 1895, 1888, 1890, 1889, 1886, 1892, 1884, 1888, 1886, 1884, 1889, 1882, 1887, 1884, 1882, 1889, 1881, 1886, 1885, 1882, 1889, 1881, 1886, 1886, 1883, 1889, 1882, 1886, 1885, 1882, 1889, 1880, 1885, 1884, 1880, 1888, 1881, 1885, 1884, 1881, 1888, 1880, 1885, 1884, 1880, 1887, 1881, 1884, 1884, 1883, 1891, 1885, 1889, 1887, 1884, 1889, 1879, 1884, 1883, 1880, 1886, 1879, 1883, 1881, 1863, 1878, 1915, 2020, 2066, 2038, 1945, 1861, 1834, 1830, 1830, 1841, 1838, 1846, 1852, 1851, 1862, 1858, 1864, 1868, 1865, 1874, 1869, 1874, 1876, 1872, 1880, 1873, 1876, 1877, 1874, 1882, 1874, 1879, 1882, 1879, 1887, 1882, 1887, 1890, 1886, 1892, 1885, 1886, 1889, 1884, 1890, 1883, 1884, 1886, 1881, 1888, 1880, 1883, 1886, 1881, 1887, 1881, 1882, 1886, 1882, 1889, 1883, 1884, 1887, 1881, 1888, 1883, 1885, 1887, 1882, 1888, 1883, 1884, 1887, 1881, 1888, 1883, 1885, 1886, 1881, 1888, 1881, 1884, 1888, 1881, 1887, 1882, 1882, 1886, 1882, 1892, 1886, 1886, 1888, 1883, 1887, 1880, 1881, 1884, 1879, 1885, 1881, 1881, 1884, 1869, 1872, 1896, 1975, 2053, 2039, 1978, 1882, 1844, 1835, 1832, 1843, 1841, 1847, 1854, 1853, 1863, 1861, 1863, 1871, 1868, 1874, 1871, 1872, 1877, 1872, 1879, 1875, 1876, 1881, 1874, 1882, 1877, 1877, 1883, 1877, 1883, 1882, 1884, 1890, 1883, 1888, 1885, 1885, 1889, 1883, 1888, 1883, 1882, 1888, 1881, 1886, 1884, 1883, 1888, 1881, 1887, 1884, 1883, 1889, 1882, 1888, 1885, 1883, 1887, 1881, 1886, 1883, 1882, 1888, 1881, 1887, 1884, 1883, 1889, 1882, 1888, 1885, 1883, 1889, 1882, 1888, 1884, 1883, 1888, 1881, 1887, 1884, 1883, 1889, 1881, 1887, 1886, 1886, 1893, 1886, 1890, 1887, 1882, 1886, 1879, 1883, 1880, 1878, 1886, 1879, 1882, 1864, 1873, 1932, 2029, 2071, 2040, 1924, 1861, 1828, 1831, 1833, 1835, 1846, 1842, 1851, 1854, 1854, 1866, 1862, 1869, 1871, 1870, 1877, 1872, 1876, 1875, 1873, 1880, 1872, 1878, 1877, 1876, 1881, 1876, 1880, 1880, 1880, 1891, 1886, 1893, 1892, 1889, 1896, 1888, 1891, 1889, 1886, 1892, 1884, 1888, 1887, 1885, 1892, 1883, 1887, 1886, 1883, 1890, 1883, 1886, 1886, 1883, 1889, 1882, 1886, 1885, 1883, 1890, 1882, 1885, 1886, 1882, 1889, 1881, 1886, 1885, 1882, 1889, 1882, 1886, 1886, 1882, 1890, 1881, 1886, 1885, 1883, 1889, 1883, 1886, 1885, 1883, 1890, 1884, 1888, 1889, 1885, 1891, 1881, 1884, 1885, 1881, 1889, 1881, 1884, 1885, 1872, 1869, 1887, 1973, 2071, 2071, 2011, 1884, 1842, 1826, 1824, 1836, 1833, 1842, 1848, 1848, 1858, 1855, 1862, 1866, 1864, 1873, 1868, 1871, 1874, 1872, 1880, 1872, 1876, 1876, 1872, 1878, 1873, 1877, 1878, 1876, 1885, 1881, 1886, 1891, 1889, 1896, 1889, 1890, 1892, 1886, 1892, 1884, 1887, 1886, 1882, 1888, 1882, 1884, 1885, 1882, 1889, 1882, 1884, 1886, 1881, 1888, 1882, 1884, 1886, 1881, 1887, 1881, 1883, 1886, 1881, 1887, 1882, 1884, 1887, 1882, 1887, 1881, 1883, 1887, 1882, 1888, 1882, 1884, 1887, 1882, 1889, 1883, 1884, 1886, 1882, 1889, 1884, 1887, 1891, 1883, 1890, 1883, 1881, 1883, 1878, 1883, 1878, 1880, 1884, 1878, 1876, 1860, 1887, 1960, 2048, 2056, 1998, 1893, 1851, 1827, 1834, 1833, 1837, 1846, 1843, 1854, 1852, 1857, 1865, 1861, 1869, 1867, 1869, 1874, 1869, 1876, 1873, 1875, 1879, 1873, 1881, 1877, 1876, 1881, 1874, 1880, 1878, 1879, 1889, 1884, 1891, 1887, 1887, 1891, 1885, 1889, 1884, 1883, 1889, 1881, 1886, 1884, 1882, 1888, 1880, 1886, 1882, 1882, 1887, 1880, 1887, 1883, 1881, 1886, 1879, 1884, 1882, 1883, 1890, 1884, 1888, 1885, 1882, 1888, 1879, 1886, 1882, 1881, 1887, 1879, 1886, 1885, 1885, 1892, 1885, 1888, 1885, 1881, 1885, 1877, 1883, 1880, 1880, 1887, 1880, 1885, 1872, 1867, 1903, 1971, 2049, 2038, 1968, 1887, 1843, 1835, 1836, 1837, 1848, 1844, 1854, 1855, 1855, 1866, 1862, 1868, 1868, 1868, 1877, 1871, 1877, 1876, 1875, 1882, 1874, 1879, 1876, 1874, 1882, 1875, 1881, 1880, 1878, 1887, 1882, 1888, 1887, 1884, 1891, 1883, 1887, 1885, 1883, 1890, 1882, 1886, 1886, 1883, 1889, 1882, 1885, 1883, 1881, 1888, 1881, 1885, 1884, 1883, 1889, 1881, 1886, 1885, 1882, 1889, 1881, 1886, 1885, 1882, 1889, 1881, 1885, 1886, 1883, 1889, 1882, 1885, 1886, 1883, 1891, 1886, 1891, 1888, 1884, 1891, 1880, 1883, 1883, 1879, 1886, 1879, 1884, 1882, 1866, 1876, 1907, 2009, 2069, 2049, 1958, 1862, 1833, 1829, 1829, 1841, 1838, 1846, 1851, 1850, 1862, 1859, 1865, 1867, 1866, 1874, 1870, 1874, 1876, 1872, 1878, 1871, 1875, 1877, 1872, 1879, 1874, 1878, 1880, 1878, 1887, 1884, 1888, 1893, 1887, 1894, 1887, 1890, 1891, 1885, 1891, 1885, 1888, 1889, 1883, 1889, 1884, 1886, 1889, 1882, 1889, 1883, 1885, 1887, 1881, 1887, 1881, 1883, 1887, 1882, 1887, 1881, 1882, 1886, 1880, 1887, 1881, 1884, 1887, 1881, 1887, 1882, 1882, 1886, 1880, 1887, 1881, 1882, 1888, 1884, 1892, 1887, 1889, 1891, 1884, 1888, 1880, 1881, 1885, 1880, 1886, 1881, 1882, 1885, 1863, 1880, 1930, 2038, 2082, 2044, 1929, 1851, 1825, 1829, 1828, 1838, 1838, 1843, 1852, 1850, 1861, 1859, 1860, 1868, 1864, 1873, 1870, 1871, 1876, 1870, 1877, 1873, 1873, 1878, 1870, 1876, 1874, 1874, 1881, 1877, 1885, 1884, 1886, 1894, 1887, 1894, 1890, 1888, 1893, 1885, 1889, 1885, 1884, 1890, 1882, 1886, 1884, 1884, 1889, 1882, 1887, 1884, 1883, 1889, 1882, 1887, 1883, 1882, 1889, 1881, 1887, 1884, 1883, 1887, 1881, 1887, 1884, 1882, 1888, 1882, 1888, 1883, 1881, 1887, 1880, 1885, 1883, 1880, 1887, 1880, 1884, 1881, 1878, 1885, 1879, 1886, 1885, 1884, 1892, 1884, 1887, 1883, 1877, 1884, 1879, 1884, 1882, 1879, 1887, 1879, 1871, 1868, 1900, 1997, 2060, 2052, 1966, 1872, 1842, 1823, 1832, 1834, 1837, 1848, 1844, 1854, 1856, 1855, 1865, 1861, 1868, 1869, 1868, 1877, 1871, 1876, 1875, 1874, 1880, 1873, 1877, 1876, 1874, 1881, 1876, 1880, 1881, 1881, 1890, 1885, 1889, 1888, 1885, 1891, 1884, 1888, 1886, 1883, 1889, 1881, 1885, 1885, 1881, 1889, 1881, 1885, 1885, 1883, 1889, 1884, 1887, 1886, 1882, 1888, 1880, 1885, 1884, 1881, 1889, 1882, 1885, 1884, 1881, 1888, 1882, 1885, 1886, 1882, 1888, 1881, 1885, 1886, 1882, 1889, 1881, 1885, 1886, 1881, 1888, 1880, 1883, 1885, 1883, 1892, 1885, 1888, 1888, 1883, 1887, 1879, 1881, 1882, 1878, 1886, 1880, 1883, 1883, 1865, 1883, 1924, 2028, 2063, 2034, 1933, 1858, 1833, 1832, 1831, 1841, 1839, 1846, 1853, 1852, 1862, 1858, 1863, 1868, 1865, 1873, 1869, 1873, 1876, 1872, 1880, 1873, 1875, 1877, 1872, 1880, 1874, 1877, 1881, 1876, 1885, 1883, 1886, 1890, 1885, 1892, 1885, 1886, 1888, 1883, 1889, 1882, 1884, 1888, 1882, 1888, 1882, 1884, 1888, 1882, 1890, 1882, 1883, 1887, 1879, 1887, 1881, 1882, 1886, 1880, 1886, 1879, 1881, 1885, 1878, 1886, 1881, 1882, 1886, 1880, 1886, 1881, 1883, 1885, 1880, 1887, 1882, 1882, 1886, 1881, 1886, 1881, 1883, 1887, 1882, 1887, 1881, 1882, 1887, 1883, 1889, 1885, 1887, 1893, 1883, 1889, 1882, 1881, 1886, 1880, 1885, 1882, 1881, 1886, 1878, 1870, 1876, 1931, 2044, 2072, 2044, 1921, 1852, 1831, 1823, 1832, 1833, 1837, 1847, 1845, 1854, 1855, 1857, 1866, 1861, 1868, 1868, 1869, 1876, 1870, 1876, 1873, 1873, 1879, 1871, 1877, 1875, 1874, 1881, 1874, 1880, 1880, 1882, 1891, 1885, 1891, 1889, 1886, 1892, 1885, 1889, 1885, 1883, 1889, 1882, 1886, 1883, 1882, 1888, 1881, 1887, 1885, 1883, 1889, 1881, 1886, 1883, 1881, 1888, 1880, 1885, 1882, 1880, 1886, 1879, 1884, 1882, 1881, 1887, 1879, 1885, 1883, 1881, 1887, 1880, 1885, 1883, 1880, 1887, 1880, 1885, 1884, 1880, 1888, 1880, 1884, 1884, 1882, 1888, 1881, 1886, 1885, 1883, 1892, 1886, 1890, 1887, 1882, 1886, 1878, 1881, 1880, 1877, 1885, 1880, 1883, 1878, 1863, 1888, 1934, 2035, 2051, 2012, 1915, 1852, 1833, 1834, 1834, 1845, 1841, 1850, 1854, 1855, 1865, 1861, 1867, 1869, 1867, 1877, 1871, 1875, 1876, 1874, 1881, 1874, 1879, 1879, 1875, 1884, 1876, 1881, 1883, 1880, 1888, 1883, 1889, 1891, 1885, 1892, 1884, 1887, 1887, 1882, 1889, 1881, 1883, 1885, 1880, 1888, 1880, 1883, 1885, 1882, 1889, 1882, 1884, 1885, 1881, 1888, 1882, 1884, 1885, 1882, 1888, 1881, 1884, 1886, 1880, 1889, 1881, 1884, 1886, 1881, 1888, 1881, 1884, 1886, 1881, 1889, 1882, 1883, 1887, 1881, 1887, 1881, 1884, 1887, 1882, 1889, 1882, 1885, 1887, 1884, 1891, 1887, 1887, 1888, 1880, 1884, 1878, 1879, 1883, 1879, 1886, 1880, 1881, 1876, 1862, 1896, 1969, 2058, 2062, 1992, 1886, 1838, 1826, 1832, 1830, 1840, 1839, 1846, 1854, 1852, 1862, 1861, 1864, 1869, 1866, 1875, 1871, 1873, 1877, 1872, 1879, 1874, 1875, 1879, 1873, 1879, 1876, 1877, 1882, 1877, 1886, 1884, 1888, 1892, 1887, 1892, 1887, 1888, 1891, 1883, 1890, 1884, 1884, 1888, 1883, 1889, 1884, 1884, 1887, 1881, 1887, 1881, 1881, 1887, 1882, 1887, 1883, 1882, 1887, 1880, 1888, 1884, 1884, 1887, 1881, 1887, 1882, 1882, 1888, 1882, 1887, 1882, 1881, 1886, 1881, 1886, 1881, 1882, 1887, 1882, 1888, 1883, 1883, 1889, 1881, 1886, 1882, 1883, 1890, 1883, 1890, 1886, 1885, 1891, 1882, 1885, 1880, 1880, 1886, 1879, 1886, 1882, 1880, 1881, 1862, 1891, 1962, 2059, 2075, 2011, 1896, 1844, 1825, 1833, 1828, 1838, 1840, 1842, 1853, 1849, 1859, 1860, 1860, 1869, 1863, 1871, 1870, 1869, 1877, 1870, 1877, 1874, 1873, 1879, 1871, 1878, 1876, 1876, 1885, 1878, 1886, 1887, 1888, 1895, 1887, 1892, 1889, 1885, 1891, 1883, 1888, 1885, 1883, 1889, 1881, 1886, 1885, 1883, 1889, 1880, 1885, 1883, 1881, 1887, 1880, 1885, 1884, 1881, 1887, 1882, 1885, 1884, 1881, 1887, 1881, 1885, 1884, 1883, 1890, 1882, 1886, 1884, 1882, 1889, 1881, 1885, 1884, 1881, 1888, 1881, 1884, 1883, 1881, 1887, 1880, 1886, 1888, 1885, 1892, 1884, 1886, 1884, 1879, 1885, 1878, 1882, 1883, 1880, 1886, 1877, 1868, 1877, 1913, 2017, 2049, 2032, 1938, 1863, 1841, 1829, 1836, 1842, 1840, 1852, 1849, 1856, 1861, 1859, 1870, 1866, 1871, 1873, 1870, 1879, 1874, 1877, 1879, 1875, 1882, 1875, 1878, 1880, 1876, 1883, 1877, 1880, 1885, 1882, 1891, 1886, 1888, 1890, 1885, 1890, 1883, 1886, 1888, 1883, 1889, 1882, 1885, 1887, 1881, 1888, 1882, 1885, 1887, 1883, 1889, 1883, 1885, 1886, 1882, 1888, 1882, 1883, 1886, 1881, 1888, 1882, 1883, 1886, 1881, 1887, 1882, 1884, 1888, 1882, 1889, 1883, 1884, 1887, 1882, 1889, 1883, 1885, 1889, 1882, 1886, 1880, 1882, 1885, 1880, 1888, 1882, 1885, 1891, 1883, 1889, 1882, 1881, 1885, 1878, 1885, 1880, 1880, 1885, 1880, 1880, 1864, 1890, 1971, 2060, 2071, 2003, 1886, 1845, 1823, 1832, 1831, 1836, 1845, 1844, 1854, 1854, 1857, 1864, 1860, 1869, 1867, 1870, 1876, 1870, 1877, 1873, 1873, 1879, 1871, 1878, 1874, 1873, 1879, 1874, 1881, 1880, 1882, 1890, 1887, 1893, 1889, 1887, 1892, 1885, 1890, 1885, 1885, 1888, 1882, 1887, 1883, 1882, 1888, 1881, 1887, 1882, 1882, 1888, 1881, 1886, 1882, 1881, 1888, 1881, 1886, 1883, 1882, 1888, 1880, 1886, 1883, 1881, 1887, 1882, 1886, 1882, 1880, 1887, 1880, 1885, 1882, 1881, 1887, 1880, 1884, 1881, 1879, 1886, 1879, 1885, 1882, 1880, 1887, 1880, 1887, 1884, 1884, 1891, 1883, 1887, 1883, 1878, 1885, 1879, 1884, 1882, 1880, 1886, 1875, 1866, 1883, 1938, 2045, 2052, 2018, 1907, 1851, 1834, 1827, 1835, 1837, 1840, 1850, 1848, 1856, 1858, 1858, 1868, 1863, 1869, 1871, 1870, 1879, 1872, 1876, 1877, 1875, 1881, 1874, 1879, 1879, 1876, 1885, 1878, 1883, 1883, 1883, 1891, 1884, 1889, 1888, 1885, 1892, 1884, 1886, 1887, 1883, 1889, 1882, 1887, 1886, 1881, 1889, 1882, 1886, 1885, 1881, 1888, 1881, 1884, 1884, 1881, 1889, 1881, 1886, 1886, 1882, 1888, 1881, 1884, 1885, 1881, 1887, 1881, 1884, 1885, 1881, 1889, 1882, 1885, 1885, 1880, 1888, 1879, 1883, 1884, 1881, 1888, 1883, 1888, 1890, 1886, 1890, 1884, 1885, 1884, 1880, 1887, 1879, 1883, 1885, 1881, 1888, 1871, 1867, 1896, 1972, 2064, 2055, 1988, 1886, 1840, 1833, 1830, 1836, 1841, 1841, 1851, 1848, 1856, 1861, 1860, 1869, 1864, 1868, 1873, 1869, 1877, 1872, 1874, 1877, 1872, 1879, 1873, 1873, 1879, 1875, 1881, 1876, 1878, 1884, 1882, 1892, 1887, 1888, 1891, 1885, 1892, 1887, 1888, 1891, 1885, 1890, 1884, 1884, 1889, 1884, 1890, 1885, 1886, 1889, 1884, 1889, 1884, 1886, 1889, 1883, 1890, 1885, 1885, 1889, 1883, 1889, 1884, 1882, 1886, 1881, 1887, 1882, 1882, 1888, 1882, 1887, 1883, 1884, 1889, 1882, 1888, 1882, 1882, 1887, 1881, 1888, 1883, 1883, 1888, 1884, 1892, 1886, 1886, 1890, 1881, 1886, 1881, 1880, 1886, 1879, 1885, 1881, 1878, 1869, 1876, 1942, 2043, 2071, 2039, 1913, 1853, 1824, 1824, 1834, 1831, 1841, 1841, 1846, 1856, 1852, 1861, 1860, 1863, 1872, 1866, 1873, 1872, 1872, 1878, 1872, 1878, 1874, 1873, 1879, 1872, 1879, 1876, 1875, 1883, 1878, 1888, 1887, 1887, 1894, 1888, 1892, 1887, 1884, 1890, 1883, 1887, 1885, 1882, 1887, 1879, 1885, 1882, 1881, 1889, 1880, 1886, 1883, 1881, 1888, 1880, 1886, 1883, 1881, 1888, 1880, 1886, 1882, 1881, 1887, 1878, 1883, 1883, 1880, 1888, 1879, 1885, 1883, 1880, 1889, 1880, 1885, 1884, 1882, 1889, 1884, 1891, 1889, 1884, 1891, 1881, 1883, 1882, 1879, 1886, 1879, 1884, 1882, 1879, 1880, 1862, 1890, 1951, 2037, 2049, 1995, 1899, 1852, 1829, 1838, 1834, 1842, 1845, 1846, 1856, 1852, 1859, 1863, 1862, 1871, 1866, 1871, 1872, 1871, 1879, 1871, 1875, 1876, 1873, 1878, 1872, 1878, 1879, 1876, 1884, 1879, 1883, 1887, 1884, 1891, 1884, 1888, 1888, 1883, 1889, 1882, 1885, 1885, 1881, 1887, 1881, 1885, 1884, 1881, 1888, 1879, 1883, 1885, 1881, 1889, 1881, 1885, 1887, 1882, 1889, 1882, 1884, 1887, 1882, 1889, 1882, 1885, 1887, 1882, 1889, 1883, 1884, 1886, 1880, 1887, 1881, 1882, 1885, 1880, 1888, 1882, 1886, 1890, 1886, 1890, 1884, 1884, 1884, 1880, 1886, 1880, 1882, 1886, 1881, 1887, 1871, 1868, 1902, 1986, 2077, 2066, 1982, 1877, 1833, 1830, 1827, 1832, 1841, 1840, 1851, 1850, 1855, 1862, 1859, 1868, 1865, 1867, 1873, 1868, 1876, 1872, 1873, 1877, 1872, 1878, 1873, 1874, 1878, 1873, 1880, 1877, 1880, 1888, 1885, 1893, 1889, 1891, 1895, 1888, 1894, 1888, 1889, 1892, 1885, 1891, 1885, 1886, 1888, 1882, 1890, 1885, 1884, 1888, 1882, 1887, 1884, 1883, 1888, 1882, 1887, 1882, 1882, 1887, 1881, 1886, 1881, 1881, 1887, 1880, 1885, 1880, 1881, 1887, 1880, 1885, 1881, 1881, 1888, 1881, 1887, 1883, 1883, 1890, 1885, 1892, 1885, 1884, 1886, 1877, 1882, 1880, 1880, 1884, 1878, 1884, 1880, 1869, 1871, 1896, 1989, 2064, 2056, 1981, 1875, 1842, 1828, 1831, 1840, 1835, 1845, 1848, 1850, 1860, 1856, 1864, 1864, 1865, 1873, 1867, 1874, 1873, 1872, 1880, 1873, 1877, 1874, 1873, 1882, 1875, 1881, 1880, 1879, 1886, 1881, 1888, 1887, 1886, 1893, 1884, 1890, 1888, 1886, 1893, 1885, 1888, 1886, 1883, 1889, 1880, 1886, 1885, 1882, 1890, 1882, 1886, 1885, 1881, 1888, 1882, 1886, 1886, 1883, 1891, 1882, 1887, 1885, 1883, 1890, 1882, 1887, 1885, 1884, 1890, 1883, 1887, 1886, 1883, 1891, 1885, 1891, 1890, 1885, 1891, 1880, 1883, 1883, 1881, 1887, 1880, 1885, 1885, 1880, 1875, 1869, 1910, 2002, 2058, 2052, 1953, 1871, 1839, 1828, 1838, 1835, 1843, 1847, 1848, 1860, 1855, 1863, 1866, 1864, 1874, 1869, 1874, 1876, 1874, 1881, 1873, 1878, 1879, 1876, 1882, 1875, 1879, 1881, 1877, 1886, 1881, 1885, 1888, 1885, 1893, 1885, 1889, 1890, 1885, 1893, 1886, 1888, 1887, 1883, 1890, 1882, 1885, 1887, 1882, 1889, 1882, 1885, 1887, 1883, 1890, 1883, 1886, 1887, 1883, 1889, 1883, 1884, 1886, 1881, 1888, 1882, 1885, 1887, 1882, 1888, 1882, 1884, 1887, 1881, 1888, 1881, 1883, 1887, 1882, 1888, 1882, 1884, 1886, 1883, 1891, 1886, 1888, 1891, 1884, 1890, 1882, 1882, 1885, 1880, 1886, 1881, 1883, 1886, 1879, 1871, 1872, 1922, 2034, 2077, 2057, 1934, 1854, 1830, 1822, 1832, 1831, 1836, 1845, 1844, 1854, 1853, 1857, 1865, 1861, 1870, 1866, 1868, 1874, 1870, 1876, 1871, 1872, 1878, 1870, 1876, 1873, 1874, 1880, 1874, 1882, 1881, 1883, 1892, 1886, 1892, 1889, 1888, 1893, 1885, 1890, 1886, 1884, 1889, 1882, 1887, 1884, 1884, 1889, 1883, 1887, 1884, 1882, 1888, 1881, 1885, 1883, 1882, 1887, 1880, 1887, 1883, 1882, 1887, 1881, 1886, 1883, 1881, 1887, 1881, 1885, 1882, 1882, 1888, 1880, 1884, 1884, 1881, 1888, 1880, 1885, 1884, 1881, 1888, 1879, 1883, 1884, 1884, 1892, 1884, 1889, 1887, 1882, 1886, 1877, 1882, 1881, 1878, 1886, 1878, 1883, 1874, 1863, 1896, 1959, 2054, 2055, 1995, 1895, 1843, 1829, 1831, 1831, 1842, 1839, 1850, 1853, 1854, 1864, 1860, 1866, 1868, 1866, 1875, 1870, 1876, 1876, 1873, 1881, 1873, 1878, 1877, 1873, 1882, 1874, 1878, 1880, 1877, 1887, 1882, 1887, 1888, 1885, 1891, 1883, 1886, 1885, 1882, 1888, 1880, 1885, 1885, 1882, 1888, 1881, 1885, 1885, 1882, 1889, 1882, 1884, 1885, 1881, 1890, 1882, 1885, 1885, 1882, 1888, 1882, 1883, 1885, 1880, 1888, 1881, 1883, 1885, 1881, 1888, 1881, 1884, 1886, 1881, 1888, 1881, 1884, 1886, 1881, 1889, 1882, 1884, 1885, 1880, 1887, 1881, 1884, 1886, 1882, 1890, 1886, 1889, 1890, 1883, 1890, 1881, 1882, 1884, 1879, 1886, 1880, 1883, 1886, 1878, 1870, 1873, 1925, 2033, 2067, 2047, 1930, 1856, 1831, 1825, 1835, 1833, 1838, 1846, 1846, 1856, 1854, 1858, 1864, 1863, 1871, 1866, 1869, 1875, 1871, 1879, 1873, 1875, 1879, 1872, 1879, 1873, 1875, 1879, 1874, 1883, 1880, 1883, 1889, 1885, 1893, 1887, 1888, 1893, 1885, 1890, 1883, 1884, 1888, 1882, 1888, 1883, 1885, 1889, 1882, 1889, 1884, 1885, 1888, 1881, 1888, 1884, 1883, 1888, 1882, 1887, 1884, 1883, 1888, 1882, 1888, 1884, 1883, 1888, 1882, 1888, 1883, 1881, 1886, 1882, 1887, 1884, 1882, 1888, 1881, 1887, 1884, 1882, 1887, 1881, 1887, 1884, 1883, 1889, 1881, 1887, 1883, 1882, 1887, 1880, 1886, 1882, 1882, 1889, 1882, 1889, 1887, 1886, 1893, 1885, 1889, 1884, 1879, 1885, 1878, 1884, 1881, 1880, 1886, 1877, 1870, 1868, 1906, 2016, 2075, 2063, 1960, 1862, 1835, 1821, 1829, 1830, 1833, 1846, 1843, 1852, 1854, 1856, 1865, 1859, 1867, 1868, 1867, 1876, 1869, 1875, 1874, 1872, 1879, 1871, 1877, 1876, 1874, 1882, 1875, 1880, 1882, 1882, 1891, 1886, 1891, 1889, 1887, 1893, 1883, 1886, 1884, 1881, 1889, 1880, 1885, 1883, 1880, 1888, 1880, 1885, 1884, 1880, 1888, 1881, 1884, 1884, 1881, 1888, 1880, 1884, 1884, 1882, 1890, 1882, 1884, 1884, 1880, 1888, 1880, 1884, 1885, 1880, 1887, 1880, 1883, 1885, 1881, 1888, 1880, 1884, 1885, 1881, 1889, 1881, 1884, 1885, 1881, 1889, 1881, 1884, 1886, 1883, 1891, 1885, 1890, 1891, 1885, 1891, 1881, 1881, 1884, 1879, 1886, 1879, 1881, 1883, 1877, 1871, 1871, 1912, 2009, 2050, 2040, 1941, 1869, 1840, 1830, 1840, 1837, 1843, 1850, 1850, 1860, 1857, 1863, 1868, 1865, 1875, 1869, 1873, 1877, 1874, 1881, 1874, 1878, 1881, 1874, 1882, 1875, 1879, 1882, 1878, 1885, 1881, 1885, 1890, 1886, 1892, 1886, 1888, 1891, 1883, 1890, 1884, 1885, 1888, 1882, 1888, 1882, 1884, 1888, 1882, 1889, 1883, 1883, 1888, 1881, 1887, 1881, 1883, 1888, 1882, 1890, 1885, 1886, 1888, 1883, 1889, 1882, 1884, 1889, 1882, 1889, 1883, 1884, 1887, 1881, 1886, 1882, 1883, 1888, 1882, 1888, 1883, 1884, 1888, 1882, 1888, 1883, 1883, 1889, 1883, 1888, 1884, 1887, 1892, 1887, 1890, 1886, 1882, 1886, 1880, 1885, 1881, 1881, 1887, 1880, 1886, 1869, 1870, 1918, 2012, 2077, 2054, 1955, 1870, 1830, 1830, 1829, 1833, 1843, 1841, 1851, 1852, 1855, 1864, 1860, 1869, 1866, 1867, 1875, 1870, 1876, 1874, 1873, 1880, 1873, 1878, 1875, 1874, 1881, 1874, 1880, 1878, 1880, 1889, 1885, 1891, 1890, 1890, 1895, 1887, 1891, 1889, 1885, 1890, 1883, 1888, 1885, 1883, 1891, 1882, 1888, 1886, 1884, 1891, 1883, 1887, 1885, 1882, 1888, 1881, 1886, 1883, 1881, 1888, 1881, 1886, 1885, 1883, 1889, 1881, 1887, 1884, 1882, 1889, 1881, 1886, 1884, 1882, 1889, 1881, 1886, 1884, 1882, 1888, 1880, 1884, 1884, 1881, 1887, 1879, 1885, 1885, 1884, 1892, 1883, 1886, 1884, 1880, 1886, 1880, 1884, 1884, 1880, 1888, 1879, 1879, 1865, 1883, 1959, 2052, 2070, 2023, 1901, 1853, 1825, 1830, 1833, 1833, 1846, 1843, 1852, 1855, 1855, 1865, 1861, 1867, 1869, 1867, 1877, 1871, 1876, 1876, 1874, 1881, 1873, 1876, 1877, 1875, 1882, 1876, 1881, 1883, 1881, 1891, 1886, 1890, 1890, 1886, 1892, 1884, 1887, 1887, 1883, 1890, 1882, 1885, 1886, 1881, 1888, 1881, 1884, 1885, 1881, 1888, 1881, 1883, 1885, 1881, 1887, 1881, 1884, 1886, 1881, 1887, 1881, 1883, 1886, 1881, 1889, 1881, 1883, 1886, 1881, 1888, 1880, 1883, 1886, 1882, 1889, 1883, 1884, 1887, 1882, 1887, 1881, 1884, 1888, 1883, 1890, 1883, 1885, 1886, 1880, 1886, 1880, 1881, 1884, 1880, 1886, 1881, 1872, 1874, 1902, 1995, 2054, 2044, 1966, 1874, 1846, 1829, 1833, 1840, 1838, 1850, 1849, 1853, 1860, 1859, 1869, 1866, 1868, 1876, 1872, 1880, 1875, 1877, 1880, 1874, 1881, 1875, 1877, 1881, 1874, 1882, 1878, 1879, 1885, 1881, 1888, 1885, 1886, 1890, 1885, 1891, 1884, 1884, 1888, 1883, 1889, 1884, 1884, 1889, 1883, 1890, 1885, 1885, 1890, 1883, 1889, 1884, 1884, 1889, 1883, 1889, 1885, 1884, 1890, 1882, 1888, 1884, 1882, 1887, 1881, 1887, 1882, 1882, 1888, 1882, 1886, 1883, 1882, 1886, 1879, 1886, 1883, 1883, 1889, 1881, 1887, 1883, 1882, 1887, 1882, 1889, 1887, 1885, 1893, 1884, 1889, 1883, 1881, 1887, 1880, 1886, 1883, 1882, 1887, 1878, 1869, 1873, 1920, 2030, 2069, 2050, 1937, 1856, 1834, 1824, 1833, 1834, 1837, 1847, 1846, 1854, 1856, 1858, 1868, 1862, 1869, 1869, 1869, 1877, 1870, 1876, 1874, 1872, 1879, 1873, 1877, 1875, 1874, 1881, 1874, 1881, 1882, 1882, 1893, 1887, 1892, 1891, 1888, 1894, 1885, 1889, 1887, 1885, 1892, 1882, 1887, 1886, 1883, 1890, 1883, 1886, 1885, 1881, 1889, 1881, 1886, 1885, 1883, 1891, 1882, 1886, 1886, 1884, 1890, 1883, 1886, 1885, 1882, 1890, 1882, 1886, 1885, 1882, 1889, 1882, 1886, 1883, 1881, 1888, 1881, 1885, 1884, 1882, 1887, 1880, 1884, 1884, 1880, 1888, 1882, 1885, 1886, 1886, 1890, 1884, 1886, 1884, 1880, 1887, 1880, 1884, 1884, 1880, 1888, 1871, 1867, 1897, 1977, 2070, 2060, 1990, 1881, 1836, 1830, 1825, 1832, 1837, 1838, 1851, 1849, 1856, 1859, 1858, 1869, 1864, 1869, 1872, 1869, 1879, 1872, 1875, 1878, 1874, 1881, 1874, 1876, 1879, 1874, 1883, 1876, 1881, 1885, 1883, 1893, 1886, 1888, 1890, 1885, 1891, 1885, 1886, 1888, 1882, 1889, 1884, 1885, 1887, 1882, 1890, 1882, 1884, 1886, 1880, 1888, 1882, 1884, 1887, 1881, 1888, 1881, 1884, 1886, 1881, 1888, 1882, 1883, 1887, 1881, 1888, 1881, 1883, 1886, 1881, 1887, 1882, 1884, 1886, 1880, 1886, 1880, 1882, 1885, 1879, 1887, 1883, 1887, 1890, 1884, 1891, 1883, 1882, 1886, 1880, 1885, 1880, 1882, 1887, 1881, 1883, 1865, 1882, 1938, 2030, 2059, 2021, 1916, 1861, 1830, 1834, 1833, 1838, 1847, 1844, 1855, 1855, 1858, 1866, 1862, 1871, 1869, 1871, 1877, 1872, 1879, 1875, 1875, 1879, 1873, 1880, 1876, 1875, 1881, 1875, 1881, 1879, 1880, 1889, 1884, 1890, 1887, 1887, 1892, 1884, 1889, 1884, 1884, 1890, 1882, 1888, 1884, 1882, 1888, 1882, 1887, 1883, 1881, 1887, 1881, 1886, 1883, 1881, 1888, 1880, 1886, 1883, 1881, 1888, 1882, 1887, 1884, 1882, 1889, 1881, 1886, 1885, 1882, 1888, 1881, 1886, 1883, 1882, 1888, 1881, 1886, 1885, 1883, 1891, 1883, 1886, 1885, 1882, 1890, 1882, 1887, 1884, 1883, 1892, 1885, 1890, 1887, 1884, 1889, 1878, 1883, 1882, 1880, 1887, 1880, 1884, 1883, 1868, 1875, 1907, 2012, 2072, 2054, 1960, 1862, 1833, 1826, 1827, 1838, 1836, 1843, 1848, 1849, 1861, 1856, 1863, 1866, 1865, 1875, 1868, 1873, 1874, 1872, 1880, 1873, 1876, 1875, 1873, 1879, 1873, 1877, 1876, 1876, 1885, 1881, 1888, 1889, 1886, 1894, 1887, 1889, 1890, 1885, 1892, 1885, 1887, 1888, 1884, 1892, 1884, 1886, 1887, 1883, 1890, 1883, 1885, 1886, 1883, 1889, 1882, 1885, 1886, 1882, 1889, 1882, 1885, 1887, 1882, 1888, 1881, 1884, 1886, 1881, 1889, 1882, 1885, 1888, 1882, 1889, 1882, 1884, 1887, 1883, 1888, 1881, 1882, 1887, 1880, 1887, 1880, 1882, 1885, 1881, 1889, 1883, 1885, 1889, 1886, 1891, 1884, 1883, 1884, 1879, 1885, 1878, 1879, 1883, 1878, 1884, 1872, 1864, 1894, 1967, 2065, 2058, 1997, 1889, 1839, 1830, 1826, 1830, 1838, 1837, 1848, 1847, 1852, 1860, 1859, 1868, 1865, 1868, 1873, 1869, 1876, 1871, 1873, 1877, 1872, 1878, 1873, 1874, 1878, 1873, 1881, 1877, 1879, 1885, 1881, 1889, 1886, 1886, 1891, 1885, 1889, 1884, 1884, 1888, 1880, 1887, 1883, 1882, 1887, 1880, 1886, 1882, 1882, 1888, 1881, 1886, 1883, 1881, 1887, 1879, 1886, 1882, 1881, 1887, 1880, 1885, 1883, 1881, 1887, 1879, 1884, 1882, 1882, 1888, 1880, 1885, 1882, 1879, 1888, 1879, 1886, 1884, 1882, 1888, 1880, 1886, 1883, 1881, 1889, 1882, 1889, 1889, 1887, 1893, 1883, 1886, 1883, 1881, 1886, 1877, 1884, 1882, 1878, 1885, 1866, 1871, 1906, 1993, 2064, 2042, 1959, 1871, 1834, 1834, 1829, 1838, 1840, 1843, 1855, 1852, 1859, 1861, 1862, 1871, 1865, 1872, 1872, 1871, 1880, 1873, 1878, 1877, 1873, 1881, 1872, 1877, 1877, 1874, 1882, 1876, 1883, 1885, 1883, 1891, 1885, 1889, 1888, 1885, 1893, 1884, 1888, 1887, 1882, 1889, 1881, 1886, 1886, 1882, 1890, 1882, 1885, 1885, 1881, 1888, 1881, 1884, 1885, 1882, 1888, 1881, 1887, 1886, 1881, 1888, 1882, 1884, 1885, 1881, 1889, 1881, 1885, 1885, 1881, 1890, 1882, 1885, 1885, 1881, 1889, 1882, 1884, 1886, 1883, 1888, 1881, 1884, 1885, 1881, 1888, 1882, 1885, 1888, 1885, 1894, 1887, 1886, 1887, 1880, 1885, 1878, 1881, 1883, 1878, 1886, 1880, 1879, 1867, 1878, 1946, 2045, 2073, 2036, 1909, 1851, 1822, 1825, 1831, 1830, 1843, 1842, 1848, 1854, 1853, 1864, 1861, 1865, 1870, 1867, 1875, 1870, 1873, 1877, 1872, 1877, 1874, 1874, 1878, 1872, 1880, 1875, 1877, 1883, 1880, 1889, 1887, 1889, 1893, 1887, 1892, 1887, 1887, 1891, 1885, 1890, 1885, 1885, 1890, 1882, 1888, 1883, 1884, 1887, 1881, 1887, 1883, 1883, 1887, 1881, 1887, 1882, 1882, 1888, 1880, 1888, 1883, 1883, 1888, 1881, 1889, 1883, 1883, 1888, 1881, 1888, 1884, 1884, 1889, 1883, 1888, 1884, 1883, 1888, 1882, 1887, 1883, 1882, 1888, 1880, 1886, 1883, 1882, 1889, 1882, 1888, 1887, 1887, 1891, 1883, 1885, 1881, 1880, 1886, 1878, 1885, 1883, 1882, 1886, 1865, 1879, 1924, 2025, 2065, 2031, 1932, 1860, 1830, 1835, 1831, 1839, 1841, 1845, 1856, 1852, 1860, 1862, 1861, 1871, 1866, 1872, 1872, 1872, 1879, 1873, 1879, 1877, 1875, 1882, 1874, 1879, 1880, 1877, 1886, 1878, 1884, 1886, 1886, 1893, 1885, 1890, 1888, 1884, 1891, 1883, 1886, 1885, 1882, 1888, 1880, 1885, 1883, 1881, 1888, 1880, 1885, 1884, 1881, 1888, 1880, 1885, 1884, 1881, 1888, 1880, 1884, 1884, 1881, 1889, 1882, 1886, 1885, 1882, 1889, 1882, 1886, 1884, 1882, 1890, 1882, 1886, 1885, 1882, 1888, 1880, 1884, 1884, 1881, 1889, 1881, 1883, 1884, 1881, 1889, 1883, 1887, 1888, 1884, 1893, 1884, 1887, 1885, 1879, 1886, 1879, 1883, 1884, 1879, 1886, 1874, 1866, 1887, 1947, 2053, 2057, 2014, 1903, 1845, 1832, 1827, 1834, 1839, 1839, 1851, 1848, 1854, 1860, 1859, 1869, 1864, 1868, 1873, 1868, 1877, 1872, 1875, 1878, 1873, 1880, 1874, 1876, 1879, 1875, 1883, 1877, 1879, 1884, 1883, 1892, 1886, 1887, 1891, 1886, 1891, 1884, 1885, 1888, 1883, 1890, 1884, 1884, 1887, 1882, 1889, 1883, 1885, 1889, 1882, 1889, 1883, 1883, 1887, 1882, 1889, 1883, 1882, 1887, 1880, 1887, 1882, 1883, 1887, 1881, 1888, 1882, 1884, 1887, 1880, 1887, 1882, 1883, 1887, 1881, 1888, 1882, 1883, 1889, 1881, 1889, 1885, 1886, 1889, 1882, 1888, 1883, 1884, 1889, 1882, 1888, 1882, 1884, 1890, 1884, 1890, 1886, 1887, 1890, 1881, 1885, 1882, 1881, 1886, 1879, 1886, 1880, 1869, 1870, 1897, 2002, 2075, 2065, 1978, 1868, 1836, 1824, 1826, 1837, 1834, 1845, 1846, 1849, 1859, 1855, 1864, 1863, 1864, 1873, 1867, 1875, 1872, 1872, 1878, 1872, 1878, 1874, 1873, 1881, 1873, 1880, 1879, 1878, 1886, 1881, 1890, 1890, 1889, 1896, 1888, 1894, 1891, 1888, 1893, 1885, 1889, 1887, 1884, 1891, 1883, 1888, 1886, 1884, 1889, 1883, 1886, 1886, 1882, 1888, 1880, 1885, 1884, 1881, 1889, 1881, 1885, 1884, 1881, 1889, 1881, 1885, 1886, 1883, 1890, 1881, 1886, 1883, 1881, 1887, 1881, 1884, 1883, 1881, 1888, 1880, 1885, 1884, 1881, 1888, 1880, 1884, 1882, 1879, 1887, 1880, 1885, 1885, 1882, 1890, 1884, 1889, 1888, 1884, 1890, 1880, 1881, 1881, 1877, 1886, 1879, 1883, 1883, 1870, 1872, 1893, 1975, 2056, 2047, 1987, 1881, 1844, 1830, 1830, 1840, 1837, 1845, 1850, 1851, 1862, 1856, 1863, 1866, 1865, 1873, 1868, 1873, 1875, 1872, 1881, 1874, 1876, 1877, 1875, 1883, 1876, 1881, 1883, 1879, 1887, 1882, 1886, 1889, 1886, 1892, 1884, 1887, 1888, 1883, 1889, 1882, 1885, 1887, 1882, 1888, 1881, 1884, 1887, 1882, 1888, 1881, 1884, 1886, 1882, 1889, 1882, 1884, 1887, 1883, 1888, 1883, 1885, 1889, 1883, 1890, 1883, 1885, 1888, 1883, 1888, 1883, 1884, 1887, 1882, 1889, 1885, 1885, 1887, 1882, 1888, 1882, 1884, 1887, 1882, 1889, 1882, 1883, 1886, 1882, 1891, 1885, 1888, 1892, 1885, 1890, 1882, 1882, 1886, 1880, 1887, 1882, 1882, 1886, 1867, 1873, 1904, 1996, 2068, 2050, 1972, 1873, 1836, 1832, 1829, 1839, 1837, 1841, 1851, 1850, 1861, 1858, 1862, 1869, 1865, 1873, 1870, 1872, 1878, 1872, 1879, 1874, 1876, 1881, 1874, 1880, 1877, 1879, 1883, 1877, 1886, 1884, 1886, 1893, 1887, 1894, 1889, 1887, 1892, 1884, 1890, 1886, 1884, 1890, 1882, 1888, 1885, 1883, 1889, 1882, 1889, 1884, 1883, 1888, 1882, 1888, 1885, 1883, 1889, 1883, 1888, 1884, 1883, 1889, 1882, 1887, 1884, 1882, 1889, 1881, 1888, 1885, 1884, 1889, 1882, 1887, 1884, 1883, 1889, 1881, 1886, 1884, 1881, 1888, 1882, 1887, 1884, 1883, 1888, 1881, 1886, 1886, 1884, 1892, 1886, 1890, 1887, 1885, 1890, 1879, 1883, 1881, 1880, 1887, 1880, 1885, 1882, 1865, 1879, 1919, 2030, 2076, 2050, 1945, 1854, 1830, 1826, 1827, 1838, 1835, 1844, 1848, 1849, 1861, 1856, 1863, 1864, 1864, 1873, 1868, 1874, 1874, 1873, 1879, 1871, 1875, 1874, 1871, 1880, 1872, 1878, 1879, 1877, 1886, 1881, 1889, 1890, 1889, 1896, 1887, 1890, 1889, 1886, 1893, 1886, 1890, 1889, 1885, 1891, 1883, 1887, 1888, 1884, 1891, 1883, 1886, 1886, 1883, 1891, 1884, 1888, 1888, 1884, 1891, 1885, 1886, 1887, 1884, 1892, 1883, 1887, 1887, 1884, 1891, 1883, 1885, 1885, 1883, 1890, 1881, 1885, 1885, 1882, 1888, 1881, 1884, 1884, 1880, 1887, 1881, 1883, 1884, 1880, 1888, 1881, 1885, 1887, 1883, 1892, 1885, 1886, 1885, 1879, 1884, 1878, 1879, 1881, 1876, 1884, 1876, 1875, 1864, 1878, 1950, 2050, 2070, 2028, 1902, 1851, 1823, 1826, 1833, 1831, 1842, 1841, 1847, 1854, 1853, 1864, 1860, 1865, 1871, 1867, 1875, 1871, 1873, 1877, 1872, 1879, 1874, 1875, 1878, 1874, 1882, 1877, 1879, 1884, 1880, 1890, 1885, 1887, 1890, 1884, 1891, 1885, 1885, 1889, 1882, 1888, 1883, 1883, 1888, 1881, 1888, 1882, 1883, 1887, 1881, 1887, 1881, 1881, 1887, 1881, 1888, 1883, 1882, 1887, 1882, 1889, 1883, 1883, 1888, 1882, 1889, 1883, 1884, 1888, 1882, 1888, 1884, 1883, 1889, 1882, 1889, 1885, 1884, 1889, 1882, 1888, 1883, 1883, 1889, 1883, 1890, 1887, 1887, 1893, 1886, 1889, 1882, 1882, 1887, 1881, 1886, 1882, 1881, 1886, 1876, 1869, 1874, 1918, 2022, 2050, 2033, 1931, 1861, 1839, 1828, 1837, 1838, 1841, 1853, 1848, 1858, 1858, 1860, 1869, 1865, 1872, 1871, 1871, 1879, 1871, 1878, 1877, 1876, 1884, 1876, 1882, 1880, 1877, 1884, 1877, 1883, 1882, 1883, 1892, 1885, 1891, 1888, 1886, 1891, 1883, 1889, 1887, 1885, 1891, 1883, 1887, 1886, 1884, 1891, 1883, 1886, 1886, 1882, 1890, 1883, 1887, 1885, 1882, 1889, 1881, 1886, 1886, 1882, 1890, 1881, 1885, 1885, 1881, 1888, 1881, 1885, 1886, 1883, 1889, 1882, 1886, 1886, 1882, 1889, 1882, 1886, 1886, 1882, 1890, 1882, 1886, 1887, 1885, 1893, 1887, 1891, 1889, 1884, 1887, 1879, 1883, 1883, 1879, 1887, 1879, 1883, 1880, 1862, 1887, 1941, 2050, 2075, 2029, 1916, 1848, 1827, 1828, 1827, 1840, 1836, 1844, 1850, 1850, 1861, 1859, 1865, 1867, 1864, 1873, 1868, 1872, 1875, 1871, 1878, 1871, 1873, 1876, 1872, 1878, 1872, 1875, 1880, 1877, 1886, 1883, 1888, 1892, 1889, 1896, 1888, 1889, 1892, 1885, 1891, 1884, 1886, 1890, 1883, 1890, 1883, 1884, 1887, 1882, 1889, 1883, 1884, 1886, 1881, 1888, 1882, 1883, 1887, 1881, 1888, 1882, 1882, 1887, 1881, 1886, 1880, 1882, 1887, 1882, 1887, 1882, 1883, 1887, 1881, 1888, 1884, 1884, 1888, 1881, 1889, 1882, 1883, 1887, 1880, 1887, 1882, 1884, 1890, 1886, 1892, 1885, 1884, 1886, 1878, 1884, 1881, 1881, 1886, 1879, 1884, 1878, 1863, 1881, 1925, 2033, 2060, 2031, 1930, 1855, 1834, 1828, 1832, 1841, 1838, 1849, 1848, 1852, 1860, 1856, 1866, 1865, 1865, 1873, 1869, 1876, 1874, 1873, 1878, 1872, 1878, 1875, 1875, 1882, 1875, 1881, 1880, 1877, 1888, 1882, 1889, 1888, 1887, 1894, 1885, 1889, 1885, 1884, 1889, 1882, 1887, 1884, 1884, 1889, 1882, 1886, 1884, 1883, 1890, 1882, 1888, 1885, 1883, 1890, 1881, 1887, 1884, 1883, 1891, 1882, 1886, 1885, 1883, 1890, 1882, 1886, 1886, 1882, 1889, 1881, 1886, 1884, 1881, 1888, 1880, 1885, 1887, 1885, 1894, 1885, 1889, 1887, 1883, 1886, 1879, 1882, 1882, 1880, 1886, 1879, 1883, 1882, 1864, 1884, 1921, 2022, 2054, 2026, 1934, 1858, 1836, 1834, 1833, 1844, 1840, 1848, 1853, 1854, 1865, 1861, 1867, 1870, 1868, 1876, 1869, 1874, 1876, 1873, 1882, 1874, 1878, 1880, 1875, 1884, 1877, 1881, 1882, 1878, 1887, 1881, 1886, 1889, 1885, 1892, 1885, 1888, 1888, 1884, 1890, 1883, 1885, 1888, 1883, 1891, 1884, 1887, 1889, 1884, 1891, 1885, 1886, 1889, 1884, 1890, 1883, 1885, 1888, 1884, 1892, 1885, 1887, 1889, 1884, 1890, 1884, 1886, 1889, 1884, 1890, 1884, 1886, 1888, 1883, 1891, 1885, 1884, 1887, 1882, 1888, 1881, 1884, 1890, 1885, 1892, 1886, 1886, 1889, 1880, 1886, 1881, 1882, 1887, 1881, 1888, 1882, 1880, 1869, 1879, 1942, 2042, 2071, 2040, 1913, 1854, 1826, 1827, 1835, 1834, 1843, 1841, 1847, 1856, 1853, 1863, 1862, 1863, 1872, 1867, 1874, 1871, 1872, 1879, 1872, 1876, 1873, 1873, 1879, 1873, 1878, 1876, 1876, 1884, 1879, 1890, 1889, 1889, 1896, 1889, 1894, 1890, 1887, 1894, 1885, 1889, 1886, 1883, 1891, 1884, 1889, 1886, 1884, 1890, 1883, 1887, 1885, 1884, 1890, 1881, 1886, 1885, 1883, 1889, 1881, 1886, 1884, 1883, 1890, 1881, 1886, 1885, 1883, 1888, 1881, 1886, 1884, 1882, 1890, 1883, 1886, 1884, 1881, 1888, 1880, 1885, 1883, 1881, 1888, 1880, 1884, 1885, 1882, 1889, 1883, 1888, 1886, 1883, 1888, 1879, 1882, 1882, 1880, 1886, 1879, 1885, 1882, 1864, 1879, 1923, 2033, 2076, 2047, 1941, 1853, 1829, 1827, 1827, 1838, 1835, 1844, 1849, 1850, 1860, 1855, 1862, 1865, 1864, 1873, 1867, 1871, 1874, 1872, 1880, 1873, 1876, 1877, 1872, 1880, 1873, 1878, 1880, 1877, 1885, 1882, 1888, 1890, 1887, 1893, 1885, 1887, 1888, 1883, 1891, 1884, 1886, 1887, 1882, 1889, 1882, 1885, 1887, 1881, 1888, 1882, 1884, 1886, 1881, 1887, 1881, 1885, 1886, 1880, 1888, 1881, 1882, 1884, 1879, 1886, 1879, 1884, 1885, 1881, 1888, 1881, 1882, 1885, 1881, 1887, 1881, 1883, 1886, 1880, 1887, 1881, 1883, 1887, 1880, 1889, 1884, 1887, 1891, 1885, 1891, 1881, 1880, 1884, 1879, 1885, 1878, 1880, 1884, 1879, 1882, 1864, 1883, 1943, 2035, 2058, 2015, 1908, 1856, 1828, 1836, 1834, 1839, 1848, 1847, 1857, 1855, 1859, 1867, 1862, 1872, 1868, 1869, 1876, 1870, 1878, 1874, 1876, 1880, 1874, 1880, 1875, 1876, 1881, 1875, 1882, 1878, 1881, 1888, 1884, 1892, 1888, 1888, 1893, 1886, 1891, 1886, 1885, 1890, 1884, 1889, 1886, 1885, 1890, 1883, 1888, 1884, 1883, 1889, 1882, 1887, 1884, 1883, 1890, 1882, 1888, 1884, 1883, 1890, 1882, 1888, 1884, 1882, 1888, 1881, 1887, 1884, 1883, 1889, 1881, 1887, 1884, 1882, 1890, 1883, 1887, 1885, 1884, 1890, 1882, 1887, 1885, 1883, 1890, 1883, 1889, 1888, 1887, 1892, 1882, 1888, 1883, 1879, 1887, 1880, 1885, 1884, 1882, 1889, 1881, 1873, 1873, 1911, 2020, 2074, 2061, 1956, 1861, 1836, 1822, 1831, 1834, 1834, 1846, 1844, 1853, 1856, 1856, 1866, 1860, 1867, 1869, 1868, 1876, 1869, 1874, 1876, 1872, 1879, 1872, 1877, 1876, 1874, 1881, 1874, 1880, 1883, 1882, 1893, 1887, 1892, 1894, 1889, 1896, 1887, 1889, 1890, 1886, 1893, 1884, 1887, 1888, 1884, 1892, 1883, 1886, 1887, 1883, 1890, 1882, 1884, 1886, 1883, 1889, 1882, 1884, 1886, 1881, 1888, 1882, 1884, 1886, 1882, 1889, 1882, 1883, 1886, 1881, 1887, 1881, 1884, 1888, 1882, 1887, 1881, 1883, 1887, 1880, 1887, 1881, 1883, 1886, 1879, 1886, 1881, 1884, 1887, 1883, 1890, 1885, 1885, 1889, 1881, 1885, 1878, 1879, 1885, 1878, 1885, 1880, 1880, 1876, 1866, 1902, 1981, 2057, 2055, 1974, 1884, 1841, 1829, 1837, 1834, 1843, 1842, 1847, 1856, 1854, 1864, 1862, 1864, 1869, 1867, 1875, 1872, 1873, 1879, 1872, 1878, 1875, 1874, 1880, 1874, 1881, 1877, 1878, 1885, 1880, 1889, 1886, 1887, 1893, 1886, 1891, 1887, 1886, 1891, 1883, 1889, 1884, 1883, 1890, 1882, 1889, 1885, 1884, 1889, 1882, 1888, 1885, 1884, 1890, 1882, 1888, 1884, 1883, 1889, 1882, 1887, 1884, 1882, 1888, 1881, 1886, 1884, 1882, 1889, 1882, 1887, 1883, 1882, 1888, 1881, 1887, 1884, 1883, 1888, 1881, 1888, 1884, 1881, 1889, 1881, 1887, 1887, 1885, 1892, 1886, 1892, 1891, 1886, 1892, 1881, 1884, 1883, 1880, 1887, 1879, 1884, 1884, 1880, 1874, 1868, 1914, 2012, 2068, 2058, 1953, 1870, 1834, 1826, 1837, 1832, 1840, 1844, 1847, 1859, 1855, 1862, 1863, 1863, 1872, 1867, 1873, 1873, 1871, 1879, 1872, 1876, 1877, 1874, 1881, 1873, 1877, 1879, 1876, 1884, 1880, 1885, 1890, 1888, 1896, 1889, 1893, 1893, 1887, 1894, 1886, 1888, 1888, 1884, 1891, 1884, 1888, 1888, 1884, 1891, 1884, 1885, 1889, 1883, 1889, 1881, 1885, 1886, 1883, 1890, 1883, 1886, 1888, 1883, 1890, 1883, 1886, 1887, 1884, 1890, 1883, 1886, 1888, 1883, 1889, 1883, 1885, 1887, 1880, 1888, 1881, 1882, 1886, 1880, 1887, 1881, 1884, 1888, 1883, 1890, 1883, 1886, 1889, 1885, 1893, 1885, 1885, 1887, 1880, 1885, 1878, 1880, 1884, 1879, 1886, 1880, 1871, 1870, 1895, 1994, 2069, 2064, 1984, 1875, 1841, 1824, 1828, 1835, 1833, 1844, 1842, 1849, 1857, 1855, 1865, 1862, 1865, 1873, 1869, 1876, 1872, 1873, 1878, 1872, 1878, 1872, 1873, 1880, 1874, 1881, 1877, 1878, 1885, 1881, 1889, 1888, 1889, 1894, 1887, 1893, 1887, 1886, 1891, 1883, 1888, 1883, 1882, 1888, 1881, 1886, 1883, 1883, 1889, 1881, 1886, 1883, 1881, 1888, 1881, 1886, 1882, 1881, 1888, 1881, 1887 };

uint8_t ADC_buffer_full = 0;
volatile uint16_t ADC_buffer_nextwriteindex = 0;
volatile uint16_t ADC_buffer_nextreadindex = 0;
volatile short ADCbuffer[RINGBUFFERSIZE];

//The current mode which the controller is in, alawys start with live mode
Modes currentMode = Modes::LIVE;

//keeps track of the current time of the long time ekg
volatile unsigned long long ekg_timer = 0;
//Use -1 as default which marks it as null state
unsigned long long ekg_start_time_ms = -1;

std::map<byte, OPCodes> OPCodes_Mapping = {
	{0, OPCodes::NO_OP},
	{1, OPCodes::LIST_EKG},
	{2, OPCodes::START_24H_EKG},
	{3, OPCodes::ABORT_24_H_EKG},
	{6, OPCodes::DELETE_EKG_FILE},
	{7, OPCodes::FETCH_MODE},
};

// Init NRF52 timer NRF_TIMER3
NRF52_MBED_Timer ITimer(NRF_TIMER_3);

// Init NRF52_MBED_ISRTimer
// Each NRF52_MBED_ISRTimer can service 16 different ISR-based timers
NRF52_MBED_ISRTimer ISR_Timer;

char current_ecg_filename[50];

SdFs sd;
FsFile file;
//Pin which is used for the CS 
const int CHIP_SELECT_PIN = 10;

bool updateMTUReady = false;
bool dataSendingReady = false;

BLEDevice connectedDevice;

#if USE_BATTERY
	SFE_MAX1704X lipo;
#endif // USE_BATTERY

void setup() {
	Serial.begin(9600);
	pinMode(2, INPUT);
	pinMode(3, INPUT);

	SPI.begin();

	if (!BLE.begin()) {
		Serial.println("BLE init failed!");
		while (1);
	}


	init_serial();
	init_adc();
	init_sd_card();
	init_ble();
  init_battery_status();

	if (ITimer.attachInterruptInterval(HW_TIMER_INTERVAL_MS, TimerHandler)) {
		Serial.print("Starting ITimer OK, millis() = ");
		Serial.println(millis());
	}
	else
		Serial.println("Can't set ITimer. Select another freq. or timer");

	ISR_Timer.setInterval(SAMPLETIME, timerIRQ);
}

BLEService bleService("e28e00e9-b79a-479a-a6f1-21e8f73236e1");

BLECharacteristic Signal("23b85b26-e7cb-421c-9731-1b4ca2d2a849", BLERead | BLENotify, sizeof(SAADC_RESULT_BUFFER));
BLEFloatCharacteristic BPM_blue("8a405d98-1d36-11ef-9262-0242ac120002", BLERead | BLENotify);
BLEFloatCharacteristic BATTERY_CHARACTERSTIC("363a2846-1dc7-11ef-9262-0242ac120002", BLERead | BLENotify);
BLECharacteristic APP_CHARACTERISITC("563a2846-1dc7-11ef-9262-0242ac120002", BLERead | BLEWrite | BLENotify, 512);

CommunicationService communicationService(&APP_CHARACTERISITC);
AppService appSerivce(sd);

void init_adc() {
	// Disable the SAADC during configuration
	nrf_saadc_disable();
	// Configure A2 in single ended mode
	const nrf_saadc_channel_config_t channel_config = {
	  .resistor_p = NRF_SAADC_RESISTOR_DISABLED,
	  .resistor_n = NRF_SAADC_RESISTOR_DISABLED,
	  .gain = NRF_SAADC_GAIN1_6,
	  .reference = NRF_SAADC_REFERENCE_INTERNAL,
	  .acq_time = NRF_SAADC_ACQTIME_10US,
	  .mode = NRF_SAADC_MODE_SINGLE_ENDED,
	  .burst = NRF_SAADC_BURST_DISABLED,
	  .pin_p = NRF_SAADC_INPUT_AIN6,
	  .pin_n = NRF_SAADC_INPUT_DISABLED
	};

	nrf_saadc_channel_init(1, &channel_config); 
	nrf_saadc_resolution_set(NRF_SAADC_RESOLUTION_12BIT);
	nrf_saadc_oversample_set(NRF_SAADC_OVERSAMPLE_256X);

	NRF_SAADC->SAMPLERATE = (SAADC_SAMPLERATE_MODE_Timers << SAADC_SAMPLERATE_MODE_Pos) | ((uint32_t)500 << SAADC_SAMPLERATE_CC_Pos);

	NRF_SAADC->RESULT.PTR = (uint32_t)SAADC_RESULT_BUFFER;
	NRF_SAADC->RESULT.MAXCNT = SAADC_RESULT_BUFFER_SIZE;

	nrf_saadc_enable();

	NRF_SAADC->TASKS_CALIBRATEOFFSET = 1;
	while (NRF_SAADC->EVENTS_CALIBRATEDONE == 0)
		;
	NRF_SAADC->EVENTS_CALIBRATEDONE = 0;
	while (NRF_SAADC->STATUS == (SAADC_STATUS_STATUS_Busy << SAADC_STATUS_STATUS_Pos))
		;
	Serial.println("Finished SAADC Configuration");

	nrf_saadc_task_trigger(NRF_SAADC_TASK_START); 
	delay(5); 

	nrf_saadc_task_trigger(NRF_SAADC_TASK_SAMPLE);
}

void TimerHandler() {
	ISR_Timer.run();
}

volatile int test_data_read_index = 0;


void timerIRQ() {
	
	if (Modes::EKG_24H == currentMode)
	{
		//Increase the ekg_timer by the interval which this function gets called
		ekg_timer += SAMPLETIME;
	}

	if (nrf_saadc_event_check(NRF_SAADC_EVENT_END))
	{
		nrf_saadc_event_clear(NRF_SAADC_EVENT_END); 

    //USE THIS when using real data is wanted
		/*
		for (unsigned int i = 0; i < SAADC_RESULT_BUFFER_SIZE; i++)
		{
			ADCbuffer[ADC_buffer_nextwriteindex] = SAADC_RESULT_BUFFER[i];
			ADC_buffer_nextwriteindex = (ADC_buffer_nextwriteindex + 1) % RINGBUFFERSIZE;
			LONG_TIME_DOUBLE_BUFFER.write(SAADC_RESULT_BUFFER[i]);
			
		}*/

    //Iterates over test data (needed bc prototype microcontroller has no battery)
		for (unsigned int i = 0; i < 10; i++)
		{
			LONG_TIME_DOUBLE_BUFFER.write(testdata[test_data_read_index]);

			test_data_read_index = (test_data_read_index + 1) % 7500;
		}
		

		ADC_buffer_full = 1;
		nrf_saadc_task_trigger(NRF_SAADC_TASK_START);
	}

	if (nrf_saadc_event_check(NRF_SAADC_EVENT_RESULTDONE))
		;
	{
		nrf_saadc_event_clear(NRF_SAADC_EVENT_RESULTDONE);
		nrf_saadc_task_trigger(NRF_SAADC_TASK_SAMPLE);
	}
}

void init_battery_status()
{
#if USE_BATTERY
  Serial.println("Wire begin");
	Wire.begin();
  Serial.println("Wire begin done...");
	if (!lipo.begin())
	{
		Serial.println("MAX17043 not detected!");
		return;
	}

  lipo.quickStart();

	Serial.println("MAX17043 successfully detected.");
#endif 	
}

void init_ble() {
	BLE.setLocalName("THI-EKG");
	BLE.setAdvertisedService(bleService);
	//Register handler
	BLE.setEventHandler(BLEConnected, blePeripheralConnectHandler);
	BLE.setEventHandler(BLEDisconnected, blePeripheralDisconnectHandler);
	BLE.setEventHandler(BLEMtuExchanged, bleOnMTUExchange);

	// add the characteristic to the service
	bleService.addCharacteristic(Signal);
	bleService.addCharacteristic(BPM_blue);
	bleService.addCharacteristic(BATTERY_CHARACTERSTIC);
	bleService.addCharacteristic(APP_CHARACTERISITC);

	BLE.addService(bleService);

	//Advertise the device so it can be connected to
	BLE.advertise();
}

/**
 * Handler for the BLEConnected event
 * @param connectedDevice The BLEDevice which is involved in the event
*/
void blePeripheralConnectHandler(BLEDevice connectedDevice) {
	Serial.println("Device connected");
	BLE.stopAdvertise();
	connectedDevice = connectedDevice;

	Serial.println("Stopping advertise");
}

/**
 * Handler for the BLEDisconnected event
 * @param disconnectedDevice The BLEDevice which is involved in the event
*/
void blePeripheralDisconnectHandler(BLEDevice disconnectedDevice) {
	Serial.println("Device disconnected");
	//A new device has to enable sending for itsself again
	dataSendingReady = false;

	BLE.advertise();
	Serial.println("Starting to advertise again");
}

/**
 * Handler for the BLEMtuExchanged Events
 * @param ignore The BLEDevice which was involded in this event
*/
void bleOnMTUExchange(BLEDevice ignore) {
	Serial.println("MTU-Exchange happened, data can be exchanged now.");
	updateMTUReady = true;
}

void updateMTU() {
	if (!updateMTUReady) {
		return;
	}
	//TODO maybe see if this can be set add the event handler
	communicationService.setMTU(ATT.mtu(connectedDevice));

	//Update done 
	updateMTUReady = false;
	dataSendingReady = true;
  //Send the battery now
  SEND_BATTERY_STATUS = true;
}

void init_serial()
{
#if !USE_SERIAL
	//Dont use the serial
	return;
#endif
	
		//Wait for USB Serial
		while (!Serial) {
			yield();
		}
}


/**
 * Inits the SD-Card by using the selected CHIP_SELECT_PIN
*/
void init_sd_card() {
#if !USE_SD_CARD
	//SD-Card should not be init
	Serial.println("sd card init skipped!");
	return;
#endif

	Serial.println("Trying to init SD Card..");

	if (!sd.begin(CHIP_SELECT_PIN)) {
		Serial.println("SD Card init failed!");
		return;
	}

	Serial.println("SD Card init successfully");
}

unsigned long last_time = 0;

int counter = 0;
bool send = false;


FsFile current_ekg_file;
FsFile current_bpm_file;

long timeToWrite = 0;

int counterEKG = 1;

long last = 0;

int test_data_index = 0;
long last_battery_status = 0;

void loop() {
	BLE.poll();
	unsigned long current_time = millis();

	updateMTU();

	handleAppCommunication();

	/*
	if ((last - current_time) > 3000) {
		Serial.println(lipo.getSOC());
		last = current_time;
	}
	*/

  
   if(SEND_BATTERY_STATUS || ((current_time - last_battery_status ) > BATTERY_SEND_DELAY)) {
    if(BLE.connected()){
      //Send the battery status 
      BATTERY_CHARACTERSTIC.setValue(lipo.getSOC());
      //store the last time we send the battery status
      last_battery_status = current_time;
      SEND_BATTERY_STATUS = false;
    }
   }
    
	if (ADC_buffer_full) {


		if (Modes::LIVE == currentMode) {
			last_time = current_time;

			if (BLE.connected() && dataSendingReady) {

				Signal.setValue((byte*)&(ADCbuffer[ADC_buffer_nextreadindex]), sizeof(SAADC_RESULT_BUFFER));
				//Signal.setValue((byte*)&(testdata[test_data_index]), 20);
				//Signal.writeValue(((char*) &(ADCbuffer[ADC_buffer_nextreadindex])));
			}
		}

		
		if (Modes::EKG_24H == currentMode) {

			if (LONG_TIME_DOUBLE_BUFFER.isReadable()) {
				// Is readable write it to the sd card
				timeToWrite = millis();
				if (!current_ekg_file.isOpen()) {
					Serial.println("Opening current ecg file..");
					//open it if needed
					current_ekg_file = sd.open(current_ecg_filename, FILE_WRITE);
					Serial.println("Opened current ecg file!");
				}

				short* readIndex = LONG_TIME_DOUBLE_BUFFER.readIndex();

				//SINGLE_BUFFER_SIZE * 2 bc shorts are getting written which are 2 byte each
				size_t writtenBytes = current_ekg_file.write(readIndex, SINGLE_BUFFER_SIZE * 2);

				Serial.print("Written Bytes: ");
				Serial.println(writtenBytes);
				current_ekg_file.flush();
				Serial.print("FILE SIZE: ");
				Serial.println(current_ekg_file.fileSize());
				current_ekg_file.close();

				Serial.println("First Data: ");

				for (int i = 0; i < 10; i++) {
					Serial.println(String(readIndex[i]));
				}

			
				Serial.println("Wrote to ekg file in: " + String(millis() - timeToWrite));
			}


			LONG_TIME_DOUBLE_BUFFER.readDone();

			if (ekg_timer >= FULL_EKG_TIME)
			{
				//End the 24h ecg
				end_24h_ecg();
			}
		}
		
		ADC_buffer_nextreadindex += SAADC_RESULT_BUFFER_SIZE;

		if (ADC_buffer_nextreadindex >= RINGBUFFERSIZE) {
			//RESET TO 0, if this is true then the nextreadindex is prob 500 (as the SAADC_RESULT_BUFFER_SIZE is 10)
			ADC_buffer_nextreadindex = 0;
		}

		ADC_buffer_full = 0;
	}


}


/**
* Checks if packets have been received and handles the correct handling of those
*/
void handleAppCommunication() {
	if (!APP_CHARACTERISITC.written()) {
		//Nothing written do nothing
		return;
	}

	int length = APP_CHARACTERISITC.valueLength();

	if (length == 0) {
		//Should not happen!
		Serial.println("APP_CHARACTERISTIC LENGTH is 0 !");
		return;
	}

	char buffer[length];
	APP_CHARACTERISITC.readValue(buffer, length);

	//Fetch the first byte to determine the opcode
	byte opCodeByte = buffer[0];

	auto it = OPCodes_Mapping.find(opCodeByte);

	if (it == OPCodes_Mapping.end()) {
		//Not found!
		Serial.println("Unknown OPcode" + String(opCodeByte));
		return;
	}

	OPCodes opCode = it->second;

	switch (opCode)
	{
	case OPCodes::NO_OP:
		break;
	case OPCodes::LIST_EKG:
		handleListEKGs();
		break;
	case OPCodes::START_24H_EKG:
	{
		if (!contains_delimiter(buffer, length)) {
			//No ; delimiter provided errornous data
			Serial.println("No ; delimiter provided!");
			return;
		}

		size_t delimiter_index = delimiter_at_index(&buffer[1]);

		char file_name[delimiter_index + 5];
		fill_buffer_with_null_terminator(file_name, delimiter_index + 5);
		//The current start time of the ecg in ms (send by the app)
		char time_as_str[(length - 1) - delimiter_index];
		fill_buffer_with_null_terminator(time_as_str, (length - 1) - delimiter_index);

		memcpy(file_name, &buffer[1], delimiter_index);
		size_t file_name_length = strlen(file_name);
		memcpy(&file_name[file_name_length], ".bin", 4);
		memcpy(time_as_str, &buffer[delimiter_index + 2], length - delimiter_index);

		memcpy(current_ecg_filename, file_name, delimiter_index + 5);

		handleStart24HEKG(file_name, time_as_str);
		break;
	}

		
	case OPCodes::ABORT_24_H_EKG:
		handleAbortEKG();
		break;
	case OPCodes::DELETE_EKG_FILE:
		handleDeleteEKGFile(buffer, length);
		break;
	case OPCodes::FETCH_MODE:
		handleFetchMode();
		break;
	default:
		break;
	}

}

void handleAbortEKG()
{
	if (Modes::EKG_24H != currentMode)
	{
		//Current mode is not 24H ekg, do nothing but provide a error response for the app
		char* error_msg = "EKG not in 24H state!";
		communicationService.sendErrorResponse(OPCodes::ABORT_24_H_EKG, reinterpret_cast<std::uint8_t*>(error_msg), strlen(error_msg));
		return;
	}

	//was a forced abort 
	end_24h_ecg(true);
}

void end_24h_ecg()
{
	end_24h_ecg(false);
}

/**
* Ends the ecg and switches back to live mode
* @param aborted if the 24h ecg has been aborted forcefully
*/
void end_24h_ecg(bool aborted)
{
	//Change the mode, close the file, write metadata about the file
	currentMode = Modes::LIVE;

	if (aborted)
	{
		//Everything worked
		char* success_msg = "24H EKG was aborted successfully!";
		communicationService.sendSuccessResponse(OPCodes::ABORT_24_H_EKG, reinterpret_cast<std::uint8_t*>(success_msg), strlen(success_msg));
	}

	create_meta_file(current_ecg_filename, aborted);
	init_bpm_file();
}

/**
 * Creates the mata file for the ended ecg
 * @param ecg_file_name The filename of the recorded ecg
 * @param was_aborted If the ecg recording has been aborted (ended prematurely)
*/
void create_meta_file(char *ecg_file_name, const bool was_aborted)
{

	Serial.println("Trying to create meta file..");

	const size_t file_name_length = strlen(ecg_file_name);
	char meta_file_name[file_name_length + 1];
	//Change the extension to txt
	strcpy(meta_file_name, ecg_file_name);
	memcpy(&meta_file_name[file_name_length-3],"txt", 3);

	if (sd.exists(meta_file_name))
	{
		//Should not happen
		Serial.println("Meta-File already exists, this should not happen!");
		return;
	}

	Serial.println(meta_file_name);

	FsFile meta_file = sd.open(meta_file_name, FILE_WRITE);

	if (!meta_file) {
		//Error creating the file
		Serial.println("Error while creating or opening meta file");
		return;
	}
	// Add the start time
	String start_time_data = META_FILE_ECG_START + ":" + ullToString(ekg_start_time_ms) + DELIMITER;
	meta_file.print(start_time_data);

	// Add the end time
	String end_time_data = META_FILE_ECG_END + ":" + ullToString((ekg_start_time_ms + ekg_timer)) + DELIMITER;
	meta_file.print(end_time_data);

	// Add if it was aborted
	String was_aborted_data = META_FILE_ECG_WAS_ABORTED + ":" + bool_to_string(was_aborted) + DELIMITER;
	meta_file.print(was_aborted_data);

	meta_file.flush();
	meta_file.close();
}


/*
 * Handles the fetch mode request, sends a response to the application
*/
void handleFetchMode()
{
	Serial.println("Handle fetching current mode");

	const std::uint8_t success_msg = (Modes::LIVE == currentMode) ? 0 : 1;
	communicationService.sendSuccessResponse(OPCodes::FETCH_MODE, &success_msg, 1);

}

void handleListEKGs()
{
	Serial.println("Handle list EKGs");

	String data = appSerivce.list_ecg_files();
	char EKGS[data.length() + 1];
	data.toCharArray(EKGS, sizeof(EKGS));

	communicationService.sendData(OPCodes::LIST_EKG, reinterpret_cast<std::uint8_t*>(EKGS), strlen(EKGS));
}

void handleDeleteEKGFile(char* buffer, int lenght) {
	char fileName[lenght + 4];
	memcpy(fileName, &buffer[1], lenght - 1);
	//Add the .bin extension
	memcpy(&fileName[lenght - 1], ".bin", 4);
	fileName[lenght + 3] = '\0';

	Result result = appSerivce.delete_ecg_file(fileName);

	if (result.is_ok()) {
		communicationService.sendSuccessResponse(OPCodes::DELETE_EKG_FILE, result.message(), result.message_length());
	}
	else {
		communicationService.sendErrorResponse(OPCodes::DELETE_EKG_FILE, result.message(), result.message_length());
	}
}

void handleStart24HEKG(char* file_name, char *start_time_as_str) {
	
	Serial.println("FILENAME " + String(file_name));

	Result result = appSerivce.create_ecg_file(file_name);

	if (result.is_ok())
	{
		//Reset in case if there is old data
		LONG_TIME_DOUBLE_BUFFER.reset();
		current_ekg_file = sd.open(file_name, FILE_WRITE);
		ekg_timer = 0;
		ekg_start_time_ms = strtoull(start_time_as_str, nullptr, 10);
		Serial.print("Start time: ");
		Serial.println(ekg_start_time_ms);
		currentMode = Modes::EKG_24H;

		communicationService.sendSuccessResponse(OPCodes::START_24H_EKG, result.message(), result.message_length());
	}
	else
	{
		communicationService.sendErrorResponse(OPCodes::START_24H_EKG, result.message(), result.message_length());
	}
}

void init_bpm_file()
{
	/*
	char ekg_name[50];
	size_t ekg_name_length = current_ekg_file.getName(ekg_name, 50);

	Serial.println(ekg_name);

	char* bpmFilename = (char*)malloc(ekg_name_length);

	current_bpm_file = sd.open(bpmFilename, O_CREAT | O_WRITE);

	if (!current_bpm_file) {
		//Error 
		Serial.println("Error while creating bpm file");
	}

	fill_bpm_file();

	delete bpmFilename;
	*/
	/*
	const size_t file_name_length = strlen(current_ecg_filename);
	char meta_file_name[file_name_length + 5];
	//Change the extension to txt
	strcpy(meta_file_name, current_ecg_filename);
	memcpy(&meta_file_name[file_name_length - 7], "_bpm.txt", 7);
	*/

	const size_t file_name_length = strlen(current_ecg_filename);
	char bpmFilename[file_name_length + 5]; // +5 for "_bpm.txt" being longer than ".bin"

	strcpy(bpmFilename, current_ecg_filename);
	strcpy(&bpmFilename[file_name_length - 4], "_bpm.txt");

	Serial.println(bpmFilename);

	// Open the new BPM file
	current_bpm_file = sd.open(bpmFilename, FILE_WRITE);

	if (!current_bpm_file) {
		// Error handling
		Serial.println("Error while creating BPM file");
	}
	else {
		fill_bpm_file();
		current_bpm_file.flush();
		current_bpm_file.close();
	}

}

void fill_bpm_file()
{
	current_ekg_file = sd.open(current_ecg_filename, FILE_READ);

	//7500 is equal to 10 seconds at 125Hz
	short temp_buffer[7500];
	while (true)
	{

		
		int bytes_read = current_ekg_file.read(temp_buffer, 15000);

		if (bytes_read == 0 || bytes_read < 15000)
		{
			//End of file reached
			Serial.println("End of ecg file reached, bpm calc stopped!");
			break;
		}

		int bpm = count_peaks(temp_buffer, 7500);

		current_bpm_file.print(bpm);
		current_bpm_file.print(";");

		Serial.print("Calculated BPM: ");
		Serial.println(bpm);
	}
}
